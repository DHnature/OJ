<!DOCTYPE html>
<html>
<script src="js/jquery.min.js"></script>
<head>
<meta charset="UTF-8">
<title>PostCode</title>
</head>
<body>
<!-- <input type="file" id="btn">点击提交代码</input> -->
<button id="btn">点击提交代码</button>
</body>
<script>
var code='public class Test { public static void main(String[] args) { System.out.println("hello world");}}';
var myDate = new Date();
id=Date.getMilliseconds()+Math.random()*1000;
flag=1; //用来判断是否编译完成

var a=setInterval(timer1,2000);

function test(){
	 console.log("test");
}

function timer1(){
var url="http://localhost:8080/TestWeb/Compile?method=polling";	
var json={"javaCode":code,"id":id};
	if(flag!=1){
		$.ajax({
			   type:'get',
			   url:url,
			   data:json,
			   dataType:'json',
			   success:function(json){
				   flag=1;
				   console.log("success");
				   console.log("编译结果为:    "+json.result);	
				   
			   }, 
			   error:function(json){
				   flag=1;
				   console.log("error");
				   console.log(json);
			   }	   
			});	
	}	
	};	
  

$("#btn").click(function(){	
	url="http://localhost:8080/TestWeb/Compile?method=receive";	
	id=Date.getMilliseconds()+Math.random()*1000;
	var json={"javaCode":code,"Id":id};
	flag=0;
//	ReadDemo();
	$.ajax({
		   type:'get',
		   url:url,
		   data:json,
		   dataType:'json',
		   success:function(json){
			   console.log("提交情况:    "+json.result);				   
		   }, 
		   error:function(json){
			   console.log("提交失败");		   
		   }	   
		});	
});
</script>



</html>